---
title: "Text Analysis Work"
author: "Noelle & Gael"
date: '2024-04-15'
output: html_document
---
```{r}
install.packages(c("tidyverse", 
                   "tidytext",
                   "stopwords",
                   "widyr",
                   "tidygraph",
                   "tidylo",
                   "ggraph",
                   "wordcloud",
                   "dplyr"))
```


```{r}
library(dplyr)
library(tidyverse)
library("magrittr") 
library(tidyverse)
library(tidytext)
```


```{r}
library(readr)
journal_71_72 <- read_csv("Data_Sets/journal_1871_1872 - Sheet1 (1).csv")
journal_73 <- read_csv("Data_Sets/journal_1873 - Sheet1.csv")
journal_74 <- read_csv("Data_Sets/journal_1874 - Sheet1.csv")
journal_75 <- read_csv("Data_Sets/journal_1875 - Sheet1.csv")
journal_76 <- read_csv("Data_Sets/journal_1876 - Sheet1.csv")
journal_77 <- read_csv("Data_Sets/journal_1877 - Sheet1.csv")
journal_80 <- read_csv("Data_Sets/journal_1880 - Sheet1.csv")
journal_83 <- read_csv("Data_Sets/journal_1883 - Sheet1.csv")
journal_84 <- read_csv("Data_Sets/journal_1884 - Sheet1.csv")
journal_86 <- read_csv("Data_Sets/journal_1886 - Sheet1.csv")

```

```{r}
journal_71_72$journal <- 1
journal_73$journal <- 2
journal_74$journal <- 3
journal_75$journal <- 4
journal_76$journal <- 5
journal_77$journal <- 6

journal_80$journal <- 9

journal_83$journal <- 12
journal_84$journal <- 13

journal_86$journal <- 15
```

```{r}
journal_71_72 <- journal_71_72 %>%
  rename(transcription_accuracy = transcription) %>%
  mutate(image_path = as.character(image_path)) %>%
  mutate(image_description = as.character(image_description))

journal_75 <- journal_75 %>%
  mutate(quantity = as.character(quantity)) %>%
  mutate(latitude = as.logical(latitude)) %>%
  mutate(latitude_origin = as.logical(latitude_origin)) %>%
  mutate(longitude = as.logical(longitude)) %>%
  mutate(longitude_origin = as.logical(longitude_origin))

journal_76 <- journal_76 %>%
  mutate(quantity = as.character(quantity)) %>%
  mutate(latitude = as.logical(latitude)) %>%
  mutate(latitude_origin = as.logical(latitude_origin)) %>%
  mutate(longitude = as.logical(longitude)) %>%
  mutate(longitude_origin = as.logical(longitude_origin)) %>%
  mutate(image_path = as.character(image_path)) %>%
  mutate(image_description = as.character(image_description)) %>%
  mutate(noteworthy = as.logical(noteworthy))

journal_77 <- journal_77 %>%
  mutate(quantity = as.character(quantity)) %>%
  mutate(image_path = as.character(image_path)) %>%
  mutate(image_description = as.character(image_description)) %>%
  mutate(noteworthy = as.logical(noteworthy)) %>%
  mutate(temperature_am = as.logical(temperature_am))

journal_80 <- journal_80 %>%
  mutate(image_path = as.character(image_path)) %>%
  mutate(image_description = as.character(image_description)) %>%
  mutate(noteworthy = as.logical(noteworthy)) %>%
  mutate(temperature_am = as.logical(temperature_am)) %>%
  mutate(temperature_pm = as.logical(temperature_pm)) %>%
  mutate(temperature_night = as.logical(temperature_night))
  
journal_86 <- journal_86 %>%
  mutate(image_path = as.character(image_path)) %>%
  mutate(image_description = as.character(image_description)) %>%
  mutate(noteworthy = as.logical(noteworthy)) %>%
  mutate(temperature_am = as.logical(temperature_am)) %>%
  mutate(temperature_pm = as.logical(temperature_pm)) %>%
  mutate(temperature_night = as.logical(temperature_night)) %>%
  mutate(latitude = as.logical(latitude)) %>%
  mutate(recorder = as.character(recorder)) %>%
  mutate(notes = as.character(notes)) %>%
  select(- ...37)

journal_83 <- journal_83 %>%
  mutate(image_path = as.character(image_path)) %>%
  mutate(image_description = as.character(image_description)) %>%
  mutate(noteworthy = as.logical(noteworthy)) %>%
  mutate(temperature_am = as.logical(temperature_am)) %>%
  mutate(latitude = as.logical(latitude)) %>%
  mutate(latitude_origin = as.logical(latitude_origin)) %>%
  mutate(longitude_origin = as.logical(longitude_origin)) %>%
  mutate(letter_from = as.character(letter_from))
  
journal_84 <- journal_84 %>%
  mutate(image_path = as.character(image_path)) %>%
  mutate(image_description = as.character(image_description)) %>%
  mutate(noteworthy = as.logical(noteworthy)) %>%
  mutate(temperature_am = as.logical(temperature_am)) %>%
  mutate(latitude = as.logical(latitude)) %>%
  mutate(latitude_origin = as.logical(latitude_origin)) %>%
  mutate(letter_to = as.character(letter_to))%>%
  mutate(notes = as.character(notes))
```

```{r}
journals <- dplyr::bind_rows(journal_71_72, journal_73, journal_74, journal_75, journal_76, journal_77, journal_80, journal_86)
```


```{r}
letters <- journals %>%
  filter(letter != "no letter")
```

```{r}
read_letters <- letters %>%
  filter(letter_from != "NA")
  
```
```{r}
write_letters <- letters %>%
  filter(letter_to != "NA")
```

# Count people Freeland most often recived letters from

```{r}
read_letters <- read_letters %>%
  separate(letter_from, c("person_1", "person_2", "person_3", "person_4"), sep = ",")
```
```{r}
per_1 <- read_letters %>%
  select(person_1, journal, journal_entry) %>%
  rename(from = person_1)
per_2 <- read_letters %>%
  select(person_2, journal, journal_entry) %>%
  rename(from = person_2)
per_3 <- read_letters %>%
  select(person_3, journal, journal_entry) %>%
  rename(from = person_3)
per_4 <- read_letters %>%
  select(person_4, journal, journal_entry) %>%
  rename(from = person_4)

read_letters <- dplyr::bind_rows(per_1, per_2, per_3, per_4)
```
```{r}
read_letters <- read_letters %>%
  mutate(from = str_to_title(from)) %>%
  mutate(from = trimws(from, "both")) %>%
  filter(from != "NA")
```

```{r}
(read_count <- read_letters %>%
   filter(from!= "NA") %>%
    count(from, sort = TRUE))
```

# Count people Freeland most often wrote letters to

```{r}
write_letters <- write_letters %>%
  separate(letter_to, c("person_1", "person_2", "person_3", "person_4"), sep = ",")
```
```{r}
per_1 <- write_letters %>%
  select(person_1, journal, journal_entry) %>%
  rename(to = person_1)
per_2 <- write_letters %>%
  select(person_2, journal, journal_entry) %>%
  rename(to = person_2)
per_3 <- write_letters %>%
  select(person_3, journal, journal_entry) %>%
  rename(to = person_3)
per_4 <- write_letters %>%
  select(person_4, journal, journal_entry) %>%
  rename(to = person_4)

write_letters <- dplyr::bind_rows(per_1, per_2, per_3, per_4)
```
```{r}
write_letters <- write_letters %>%
  mutate(to = str_to_title(to)) %>%
  mutate(to = trimws(to, "both")) %>%
  filter(to != "NA")
```


```{r}
(write_count <- write_letters %>%
   filter(to != "NA") %>%
    count(to, sort = TRUE))

```

#Info on idividuals
```{r}
ben_kitt <-letters %>%
  filter(grepl('Benjamin Kittridge|benjamin kittridge', letter_from))
ben_kitt_2 <-letters %>%
  filter(grepl('Benjamin Kittridge|benjamin kittridge', letter_to))

ben_kitt <- dplyr::bind_rows(ben_kitt, ben_kitt_2)
```
```{r}
(BK_words <- ben_kitt %>%
    unnest_tokens(word, journal_entry) %>%
    count(journal, word, sort = TRUE) %>%
    filter(!word %in% stop_words$word))
```
Bk mentions outside of letters
```{r}
bk_mention <-journals %>%
  filter(grepl('Benj. Kittridge|Benjamin Kittredge|Kittredge', journal_entry)) %>%
  filter(letter == "no letter")
```
```{r}
(bk_word_xletter <- bk_mention %>%
  filter(letter == "no letter") %>%
    unnest_tokens(word, journal_entry) %>%
    count(journal, word, sort = TRUE) %>%
    filter(!word %in% stop_words$word))
```
Info Obtained:
- Benjamin Kittridge lived in Bar Harbor
- talks to Freeland about a vessel
- gets meal bushels from Freeland
- Only visited in 1873

#CC Burrill
```{r}
CC_Burr <-letters %>%
  filter(grepl('Charles C. Burrill|C. C. Burrill', letter_from))
CC_Burr_2 <-letters %>%
  filter(grepl('Charles C. Burrill|C. C. Burrill', letter_to))

CC_Burr <- dplyr::bind_rows(CC_Burr, CC_Burr_2)
```
```{r}
(CC_words <- CC_Burr %>%
    unnest_tokens(word, journal_entry) %>%
    count(journal, word, sort = TRUE) %>%
    filter(!word %in% stop_words$word))
```
CB mentions outside of letters
```{r}
CB_mention <-journals %>%
  filter(grepl('CC Burrill|C.C. Burrill|C. C. Burrill|C C Burrill| Charles C. Burrill| Charles C Burrill|Chas. C. Burrill', journal_entry)) %>%
  filter(letter == "no letter")
```
```{r}
(cb_word_xletter <- CB_mention %>%
  filter(letter == "no letter") %>%
    unnest_tokens(word, journal_entry) %>%
    count(journal, word, sort = TRUE) %>%
    filter(!word %in% stop_words$word))
```
Info Obtained:
- Work with Freeland on life insurance
- Had dinner with Freeland on occation
- Travelled together to pospect Harbor
- Lived in Ellsworth
- Only mentioned visiting in 1871-1873

#Thomas Bunker
```{r}
Tom_Bunk <-letters %>%
  filter(grepl('Thomas Bunker', letter_from))
Tom_Bunk_2 <-letters %>%
  filter(grepl('Thomas Bunker', letter_to))

Tom_Bunk <- dplyr::bind_rows(Tom_Bunk, Tom_Bunk_2)
```
```{r}
(TB_words <- Tom_Bunk %>%
    unnest_tokens(word, journal_entry) %>%
    count(journal, word, sort = TRUE) %>%
    filter(!word %in% stop_words$word))
```
TB mentions outside of letters
```{r}
tb_mention <-journals %>%
  filter(grepl('Thomas Bunker|Thom Bunker|thomas Bunker', journal_entry)) %>%
  filter(letter == "no letter")
```
```{r}
(tb_word_xletter <- tb_mention %>%
  filter(letter == "no letter") %>%
    unnest_tokens(word, journal_entry) %>%
    count(journal, word, sort = TRUE) %>%
    filter(!word %in% stop_words$word))
```
Info Obtained:
- Lived on the Cranberry Isles
- Freeland often visited, had meals, & stayed overnight with TB
- Used Freeland's schooner the Sea Flower, bought from FB in 1875
- mentioned visits from 1873-1877


# Find distribution across journals

#Wrote

```{r}
count_1 <- write_letters %>%
    filter(journal == 1) %>%
           count(to) 
count_2 <- write_letters %>%
    filter(journal == 2) %>%
           count(to) 
count_3 <- write_letters %>%
    filter(journal == 3) %>%
           count(to)
count_4 <- write_letters %>%
    filter(journal == 4) %>%
           count(to)
count_5 <- write_letters %>%
    filter(journal == 5) %>%
           count(to)
count_6 <- write_letters %>%
    filter(journal == 6) %>%
           count(to) 
count_9 <- write_letters %>%
    filter(journal == 9) %>%
           count(to)
count_12 <- write_letters %>%
    filter(journal == 12) %>%
           count(to)
count_13 <- write_letters %>%
    filter(journal == 13) %>%
           count(to)
count_15 <- write_letters %>%
    filter(journal == 15) %>%
           count(to) 

```
```{r}
count_1$journal <- 1
count_2$journal <- 2
count_3$journal <- 3
count_4$journal <- 4
count_5$journal <- 5
count_6$journal <- 6
count_9$journal <- 9
count_12$journal <- 12
count_13$journal <- 13
count_15$journal <- 15
```

```{r}

to_count <- dplyr::bind_rows(count_1, count_2, count_3, count_4, count_5, count_6, count_9, count_12,count_13, count_15)
```


```{r}
to_count %>%
  group_by(journal) %>%
   filter(n > 3) %>%
  ggplot(aes(x=to, y=n)) + 
   geom_bar(stat = "identity")+
   facet_wrap(vars(journal))+
    theme(axis.text.x = element_text(angle = 60, hjust = 1))+
   labs(y = "n", x = "Location", title = "Distribution of letters written across journals")
```

#Read

```{r}
count_1 <- read_letters %>%
    filter(journal == 1) %>%
           count(from) 
count_2 <- read_letters %>%
    filter(journal == 2) %>%
           count(from) 
count_3 <- read_letters %>%
    filter(journal == 3) %>%
           count(from)
count_4 <- read_letters %>%
    filter(journal == 4) %>%
           count(from)
count_5 <- read_letters %>%
    filter(journal == 5) %>%
           count(from)
count_6 <- read_letters %>%
    filter(journal == 6) %>%
           count(from) 
count_9 <- read_letters %>%
    filter(journal == 9) %>%
           count(from)
count_12 <- read_letters %>%
    filter(journal == 12) %>%
           count(from)
count_13 <- read_letters %>%
    filter(journal == 13) %>%
           count(from)
count_15 <- read_letters %>%
    filter(journal == 15) %>%
           count(from) 

```
```{r}
count_1$journal <- 1
count_2$journal <- 2
count_3$journal <- 3
count_4$journal <- 4
count_5$journal <- 5
count_6$journal <- 6
count_9$journal <- 9
count_12$journal <- 12
count_13$journal <- 13
count_15$journal <- 15
```

```{r}

from_count <- dplyr::bind_rows(count_1, count_2, count_3, count_4, count_5, count_6, count_9, count_12,count_13, count_15)
```


```{r}
from_count %>%
  group_by(journal) %>%
   filter(n > 3) %>%
  ggplot(aes(x=from, y=n)) + 
   geom_bar(stat = "identity")+
   facet_wrap(vars(journal))+
    theme(axis.text.x = element_text(angle = 60, hjust = 1))+
   labs(y = "n", x = "Location", title = "Distribution of letters recieved across journals")
```


```{r}
top_from <- dplyr::filter(from_count, grepl('C. C. Bunker|C.C. Burrill|C.c. Bunker|CC Bunker|Charles C. Bunker|Charles C Bunker|Benjamin Kittridge|Thomas Bunker|Capt. Thomas Bunker', from))
```

```{r}
top_from %>%
  group_by(journal) %>%
  ggplot(aes(x=from, y=n)) + 
   geom_bar(stat = "identity")+
   facet_wrap(vars(journal))+
    theme(axis.text.x = element_text(angle = 60, hjust = 1))+
   labs(y = "n", x = "Location", title = "Distribution of letters recieved across journals")
```
```{r}
top_to <- dplyr::filter(to_count, grepl('C. C. Bunker|C.C. Burrill|C.c. Bunker|CC Bunker|Charles C. Bunker|Charles C Bunker|Benjamin Kittridge|Thomas Bunker|Capt. Thomas Bunker', to))
```

```{r}
top_to %>%
  group_by(journal) %>%
  ggplot(aes(x=to, y=n)) + 
   geom_bar(stat = "identity")+
   facet_wrap(vars(journal))+
    theme(axis.text.x = element_text(angle = 60, hjust = 1))+
   labs(y = "n", x = "Location", title = "Distribution of letters recieved across journals")
```
